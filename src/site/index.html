<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<title>√çndice de Poemas ‚Äî Takumi‚Äôs Garden</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{--bg:#0b0b0e;--card:#14141a;--muted:#b8b8c6;--text:#f3f3f7;--accent:#a78bfa}
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Arial}
  .wrap{max-width:920px;margin:48px auto;padding:24px}
  .card{background:var(--card);border:1px solid #1f1f28;border-radius:16px;padding:24px}
  h1{margin:0 0 8px;font-size:clamp(22px,4vw,34px)}p.muted{color:var(--muted);margin:0 0 16px}
  .controls{display:flex;gap:12px;align-items:center;margin:8px 0 16px}
  input[type="search"]{flex:1;background:#0e0e13;border:1px solid #2a2a37;color:var(--text);padding:12px 14px;border-radius:12px;font-size:16px}
  .badge{font-size:12px;color:#c7c7d4;background:#1a1a24;border:1px solid #2a2a37;padding:3px 8px;border-radius:999px}
  ul.list{list-style:none;padding:0;margin:0;display:grid;gap:10px}
  .item a{display:inline-block;padding:12px 14px;border:1px solid #232330;border-radius:12px;background:#0f0f15;text-decoration:none;color:var(--text)}
  .item a:hover{border-color:var(--accent)}.viewer{margin-top:18px;padding:18px;border:1px solid #232330;border-radius:14px;background:#0f0f15}
  .back{display:inline-block;margin-bottom:10px;text-decoration:none;color:var(--accent)}
</style>
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
<div class="wrap"><div class="card">
  <h1>üóÇÔ∏è √çndice de poemas</h1>
  <p id="status" class="muted">Cargando‚Ä¶</p>
  <div class="controls">
    <input id="q" type="search" placeholder="Buscar t√≠tulo‚Ä¶" />
    <span id="count" class="badge">0</span>
  </div>
  <ul id="lista" class="list"></ul>
  <div id="viewer" class="viewer" hidden>
    <a href="#" id="back" class="back">‚Üê Volver al √≠ndice</a>
    <div id="note"></div>
  </div>
</div></div>

<script>
  // RUTAS
  const mdPath = "notes/Escritos/Canciones-poemas-escritos/Escritos_indice_con_enlace.md";
  const baseFolder = "Escritos/Canciones-poemas-escritos";

  const $status=document.getElementById("status"),$list=document.getElementById("lista"),
        $count=document.getElementById("count"),$q=document.getElementById("q"),
        $viewer=document.getElementById("viewer"),$note=document.getElementById("note"),
        $back=document.getElementById("back");

  function titleFromTarget(t){return decodeURIComponent(t.split("/").pop().replace(/\.md$/i,""));}
  function targetToPath(t){
    const clean=t.replace(/^notes\//,'').replace(/^\//,'');
    const withFolder=clean.includes('/')?clean:`${baseFolder}/${clean}`;
    return `notes/${withFolder.replace(/\.md$/i,'')}.md`;
  }

  async function getLinksFromIndex(){
    const res = await fetch(encodeURI(mdPath));
    if(!res.ok) throw new Error
