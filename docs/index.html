<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Takumi Â· Poemas</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; padding: 2rem; background:#0b0b0f; color:#f4eafd; }
    h1 { margin: 0 0 1rem; color:#e6c9ff; }
    #status { opacity:.8; margin:.25rem 0 1rem; }
    ul { list-style: none; padding: 0; margin: 0; }
    li { margin: .35rem 0; }
    a { color:#c9a7ff; text-decoration: none; }
    a:hover { text-decoration: underline; }
    .layout { display: flex; flex-wrap: wrap; gap: 2rem; align-items: flex-start; }
    .main { flex: 1 1 18rem; }
    .side { flex: 0 1 16rem; padding: 1rem; background: rgba(255, 255, 255, 0.05); border-radius: .75rem; }
    .side h2 { margin-top: 0; margin-bottom: .5rem; color:#f7d4ff; }
    .side p { margin-top: 0; }
    @media (max-width: 720px) {
      .layout { flex-direction: column; }
      .side { width: 100%; padding: 1rem 1.5rem; }
    }
  </style>
</head>
<body>
  <h1>ðŸŒ¸ Poemas</h1>
  <div class="layout">
    <section class="main">
      <p id="status">Cargando poemasâ€¦</p>
      <ul id="poem-list"></ul>
    </section>
    <aside class="side">
      <h2>Colecciones</h2>
      <p id="folder-status">Cargando coleccionesâ€¦</p>
      <ul id="folder-list"></ul>
    </aside>
  </div>


 <script>
(async function () {
  const BASE = '/Takumi'; // base del repo en GitHub Pages
  const ul = document.getElementById('poem-list'); // <ul id="poem-list"> en tu HTML
  const errorBox = document.getElementById('poem-error'); // <div id="poem-error"></div>

  try {
    // Carga del Ã­ndice (ajusta la ruta si tu index.json estÃ¡ en otro sitio)
    const res = await fetch(`${BASE}/poems/index.json`, { cache: 'no-store' });
    const data = await res.json();

    // data puede ser ["A.md", "B.md"] o [{name:"A.md", path:"poems/A.md"}, ...]
    const names = (Array.isArray(data) ? data : [])
      .filter(Boolean)
      .map(item => {
        if (typeof item === 'string') return item;
        if (item && typeof item === 'object') return item.path || item.name || '';
        return '';
      })
      .filter(n => typeof n === 'string' && n.toLowerCase().endsWith('.md'))
      .map(n => n.replace(/^.*\//, ''))         // quita carpetas
      .filter(n => n.toLowerCase() !== 'index.md' && n !== '')
      .sort((a, b) => a.localeCompare(b, 'es')); // opcional: orden alfabÃ©tico

    // pinta la lista
    ul.innerHTML = '';
    for (const file of names) {
      const title = file.replace(/\.md$/i, '');
      const li = document.createElement('li');
      const a = document.createElement('a');
      a.textContent = title;
      a.href = `${BASE}/poems/${encodeURIComponent(title)}.md`;
      li.appendChild(a);
      ul.appendChild(li);
    }
  } catch (e) {
    if (errorBox) errorBox.textContent = `No se pudieron listar los poemas: ${e.message}`;
    console.error(e);
  }
})();
</script>


</body>
</html>
