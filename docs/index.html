<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Takumi ¬∑ Poemas</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; padding: 2rem; background:#0b0b0f; color:#f4eafd; }
    h1 { margin: 0 0 1rem; color:#e6c9ff; }
    #status { opacity:.8; margin:.25rem 0 1rem; }
    ul { list-style: none; padding: 0; margin: 0; }
    li { margin: .35rem 0; }
    a { color:#c9a7ff; text-decoration: none; }
    a:hover { text-decoration: underline; }
  </style>
</head>
<body>
  <h1>üå∏ Poemas</h1>
  <p id="status">Cargando poemas‚Ä¶</p>
  <ul id="poem-list"></ul>

  <script>
  (async () => {
    const status = document.getElementById('status');
    const list   = document.getElementById('poem-list');
    const url    = './poems/index.json?ts=' + Date.now(); // evita cach√©

    try {
      console.log('[Poemas] origin', location.origin, 'pathname', location.pathname);
      console.log('[Poemas] fetch', url);
      const res = await fetch(url, { cache: 'no-store' });
      console.log('[Poemas] HTTP', res.status);
      if (!res.ok) throw new Error('HTTP ' + res.status);

      const files = await res.json(); // ‚Üê YA VIENE ORDENADO. NO HACER .sort()
      console.log('[Poemas] total', files.length, files.slice(0,3));

      list.innerHTML = '';
      for (const file of files) {
        const li = document.createElement('li');
        const a  = document.createElement('a');
        a.href = './poems/viewer.html?poem=' + encodeURIComponent(file);
        a.textContent = file.replace(/\.md$/i, '');
        li.appendChild(a);
        list.appendChild(li);
      }
      status.textContent = files.length + ' poemas';
    } catch (err) {
      console.error('[Poemas] Error', err);
      status.textContent = 'No se pudieron listar los poemas: ' + err.message;
    }
  })();
  </script>
</body>
</html>
